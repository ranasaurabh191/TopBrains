USE TOPBRAINS;
GO

EXEC sp_help COURSE_INFO;

--first adding data to tables
INSERT INTO ZIPCODE_INFO (ZIP_CODE, CITY, STATE) VALUES
('10025', 'New York', 'NY'),
('10048', 'New York', 'NY'),
('11102', 'Astoria',  'NY'),
('11209', 'Brooklyn', 'NY'),
('40050', 'Mumbai',  'MH'),
('48104', 'Ann Arbor','MI'),
('06103', 'Hartford', 'CT');

INSERT INTO COURSE_INFO (COURSE_NO, COURSE_NAME, COURSE_PREREQUISITE, COST) VALUES
(10, 'Intro to SQL', NULL, 4000),
(20, 'Intro to Java', 10, 4500),
(25, 'Advanced Java', 20, 7000),
(30, 'Intro to Python', NULL, 3500),
(40, 'Database Design', 25, 2000);

INSERT INTO STUDENT_INFO (STUDENT_ID, STUDENT_FIRST_NAME, STUDENT_LAST_NAME, STREET_ADDRESS, ZIP_CODE) VALUES
(301, 'Amit',  'Sharma', 'Street 1', '10048'),
(305, 'Riya',  'Graham', 'Street 2', '11102'),
(320, 'Karan', 'Mehta',  'Street 3', '11209'),
(340, 'Sneha', 'Soni',   'Street 4', '10025'),
(360, 'Rahul', 'Verma',  'Street 5', '40050');

INSERT INTO INSTRUCTOR_INFO (INSTRUCTOR_ID, INSTRUCTOR_FIRST_NAME, INSTRUCTOR_LAST_NAME, STREET_ADDRESS, ZIP_CODE) VALUES
(1, 'John',  'Schumer', 'Instr St 1', '10025'),
(2, 'Alice', 'Miller',  'Instr St 2', '11102'),
(3, 'Brian', 'Smith',   'Instr St 3', '10048');

INSERT INTO SECTION_INFO (SECTION_ID, COURSE_NO, SECTION_NO, INSTRUCTOR_ID, LOCATION, CAPACITY) VALUES
(1001, 10, 1, 1, 'Room A', 30),
(1002, 20, 1, 2, 'Room B', 25),
(1003, 25, 1, 3, 'Room C', 20);

INSERT INTO ENROLLMENT_INFO (STUDENT_ID, SECTION_ID, ENROLLMENT_DATE) VALUES
(301, 1001, '1999-01-10'),
(305, 1002, '1999-01-15'),
(320, 1003, '1999-02-05');

INSERT INTO GRADE_INFO 
(STUDENT_ID, SECTION_ID, GRADE_TYPE_CODE, GRADE_CODE_OCCURANCE, NUMERIC_GRADE) VALUES
(301, 1001, 'FI', 1, 80),
(305, 1002, 'MT', 1, 75),
(320, 1003, 'FI', 1, 90);

--1 to 13
SELECT ZIP_CODE, CITY, STATE AS STATE_NAME FROM ZIPCODE_INFO;
SELECT DISTINCT STATE FROM ZIPCODE_INFO;
SELECT STUDENT_ID, STUDENT_FIRST_NAME + ' ' + STUDENT_LAST_NAME AS NAME FROM STUDENT_INFO;
SELECT ZIP_CODE + ', ' + CITY + ', ' + STATE AS Address FROM ZIPCODE_INFO;
SELECT COURSE_NAME FROM COURSE_INFO;
SELECT COURSE_NAME, COST FROM COURSE_INFO;
SELECT * FROM COURSE_INFO;
SELECT INSTRUCTOR_LAST_NAME, ZIP_CODE FROM INSTRUCTOR_INFO;
SELECT DISTINCT ZIP_CODE FROM STUDENT_INFO;
SELECT STUDENT_FIRST_NAME, STUDENT_LAST_NAME FROM STUDENT_INFO;
SELECT CITY, STATE, ZIP_CODE FROM ZIPCODE_INFO;
--1 to 34
SELECT STUDENT_ID, SECTION_ID, NUMERIC_GRADE
FROM GRADE_INFO
WHERE GRADE_TYPE_CODE = 'FI';

SELECT ZIP_CODE, CITY
FROM ZIPCODE_INFO
WHERE STATE = 'MI';

SELECT S.STUDENT_FIRST_NAME + ' ' + S.STUDENT_LAST_NAME AS NAME
FROM STUDENT_INFO S
JOIN ENROLLMENT_INFO E 
ON S.STUDENT_ID = E.STUDENT_ID
WHERE MONTH(E.ENROLLMENT_DATE) = 1 AND YEAR(E.ENROLLMENT_DATE) = 1999
ORDER BY NAME ASC;

SELECT SECTION_ID, INSTRUCTOR_ID
FROM SECTION_INFO
WHERE COURSE_NO IN (10, 20)
ORDER BY INSTRUCTOR_ID ASC;

SELECT STUDENT_ID, SECTION_ID, NUMERIC_GRADE
FROM GRADE_INFO
ORDER BY SECTION_ID ASC, NUMERIC_GRADE DESC;

SELECT COURSE_NO, COURSE_NAME, COST
FROM COURSE_INFO
WHERE COURSE_NAME LIKE '%Intro%';

SELECT *
FROM COURSE_INFO
WHERE SUBSTRING(COURSE_NAME, LEN(COURSE_NAME)-2, 1) = 'a';

SELECT *
FROM STUDENT_INFO
WHERE STUDENT_ID BETWEEN 300 AND 350;

SELECT *
FROM COURSE_INFO
WHERE COST BETWEEN 4000 AND 7000;

SELECT INSTRUCTOR_FIRST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME = 'Schumer';

SELECT INSTRUCTOR_FIRST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME <> 'Schumer';

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST > 4000;

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST BETWEEN 3000 AND 7000;

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST IN (4000, 4500);

SELECT STUDENT_FIRST_NAME, STREET_ADDRESS
FROM STUDENT_INFO
WHERE STUDENT_LAST_NAME LIKE 'S%';

SELECT STUDENT_FIRST_NAME, STREET_ADDRESS
FROM STUDENT_INFO
WHERE STUDENT_LAST_NAME LIKE '_o%';

SELECT INSTRUCTOR_FIRST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME NOT LIKE 'S%';

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST BETWEEN 4000 AND 4500 AND COURSE_NAME LIKE 'I%';

SELECT COURSE_NAME, COST, COURSE_PREREQUISITE
FROM COURSE_INFO
WHERE (COST = 2000 AND COURSE_PREREQUISITE = 20) OR COURSE_PREREQUISITE = 25;

SELECT COURSE_NAME, COST, COURSE_PREREQUISITE
FROM COURSE_INFO
WHERE COST = 2000 OR COURSE_PREREQUISITE IN (20,25);

SELECT *
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL;

SELECT STUDENT_LAST_NAME
FROM STUDENT_INFO
WHERE ZIP_CODE IN ('10048','11102','11209');

SELECT INSTRUCTOR_FIRST_NAME, INSTRUCTOR_LAST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME LIKE '%i%' AND ZIP_CODE = '10025';

SELECT COURSE_NAME
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NOT NULL AND COST < 1100;

SELECT DISTINCT COST
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL;

SELECT COURSE_NO, COURSE_NAME
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL
ORDER BY COURSE_NAME ASC;

SELECT COURSE_NO, COURSE_NAME
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL
ORDER BY COURSE_NAME DESC;

SELECT CITY, STATE, ZIP_CODE
FROM ZIPCODE_INFO
WHERE STATE IN ('NY','CT')
ORDER BY ZIP_CODE ASC;

SELECT ZIP_CODE, STUDENT_FIRST_NAME, STUDENT_LAST_NAME
FROM STUDENT_INFO
WHERE STUDENT_LAST_NAME = 'Graham'
ORDER BY ZIP_CODE DESC, STUDENT_FIRST_NAME ASC;

SELECT CITY + ', ' + STATE AS City_State FROM ZIPCODE_INFO;

SELECT UPPER(LEFT(STUDENT_FIRST_NAME,1)) +  LOWER(SUBSTRING(STUDENT_FIRST_NAME,2,LEN(STUDENT_FIRST_NAME)))
FROM STUDENT_INFO;

SELECT INSTRUCTOR_FIRST_NAME + ', ' + INSTRUCTOR_LAST_NAME AS NAME
FROM INSTRUCTOR_INFO;

SELECT COST,
       COST + 10 AS ADD_10,
       COST - 20 AS SUB_20,
       COST * 30 AS MUL_30,
       COST / 5 AS DIV_5
FROM COURSE_INFO;

SELECT DISTINCT NUMERIC_GRADE, NUMERIC_GRADE / 2 AS HALF_GRADE
FROM GRADE_INFO;
--1 TO 4
SELECT FORMAT(COST, '#,##0') AS COST
FROM COURSE_INFO
WHERE COURSE_NO < 25;

SELECT FORMAT(COST, '$#,##0.00') AS COST
FROM COURSE_INFO;

SELECT COURSE_NAME, ISNULL(CAST(COURSE_PREREQUISITE AS VARCHAR),'Not Applicable') AS PREREQ
FROM COURSE_INFO;

SELECT STATE,
       CASE
           WHEN STATE = 'NY' THEN 'New York'
           WHEN STATE = 'NJ' THEN 'New Jersey'
           ELSE 'Others'
       END AS STATE_NAME
FROM ZIPCODE_INFO;
